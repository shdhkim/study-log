# User::getAge 는 매개변수 식인가? (Comparator.comparing 흐름 정리)

## 0. 질문의 핵심

```java
users.sort(Comparator.comparing(User::getAge));
```

여기서 드는 의문은 다음이다.

- User::getAge 는 실행되는 코드인가?
- 값처럼 전달되는 건가?
- 아니면 매개변수로 전달되는 식(expression)인가?

결론부터 말하면 **매개변수 식으로 그대로 전달된다.**

---

## 1. 결론 요약

```java
Comparator.comparing(User::getAge)
```

에서

> `User::getAge`는  
> **comparing() 메서드의 매개변수로 전달되는 표현식(expression)** 이다.

다만 일반 값이 아니라,
**타깃 타입에 의해 함수형 인터페이스로 해석되는 함수 식**이다.

---

## 2. comparing()이 요구하는 매개변수 타입

`Comparator.comparing`의 시그니처는 다음과 같다.

```java
static <T, U extends Comparable<? super U>>
Comparator<T> comparing(Function<? super T, ? extends U> keyExtractor)
```

즉 comparing()은 다음 형태의 매개변수를 요구한다.

```java
Function<User, Integer>
```

---

## 3. User::getAge 는 단독으로는 타입이 없다

```java
User::getAge
```

이 표현식은 단독으로는 다음 중 어느 것도 아니다.

- Function
- Comparator
- 메서드 호출

즉 **아직 타입이 정해지지 않은 메서드 참조 표현식**이다.

---

## 4. 타깃 타입에 의해 의미가 결정된다

다음 코드에서

```java
Comparator.comparing(User::getAge)
```

컴파일러는 이렇게 판단한다.

1. comparing()은 Function을 요구한다
2. User::getAge 를 Function 자리에 넣어야 한다
3. 따라서 User::getAge 는 다음과 같이 해석된다

```java
(User u) -> u.getAge()
```

즉,

```java
Function<User, Integer>
```

로 타입이 확정된다.

---

## 5. 매개변수로 전달되는 것은 "실행 결과"가 아니다

중요한 포인트:

```java
Comparator.comparing(User::getAge)
```

는 다음과 같은 의미가 아니다.

```java
Comparator.comparing(25)        // ❌ 값 전달
Comparator.comparing(getAge())  // ❌ 실행 결과 전달
```

실제 의미는 다음과 같다.

```java
Comparator.comparing((User u) -> u.getAge())
```

즉,

- 값을 전달하는 것이 아니라
- **실행 방법(함수 자체)을 전달**하는 것이다

---

## 6. User::getAge 는 언제 실행되는가?

```java
Comparator.comparing(User::getAge)
```

이 시점에서는 getAge()가 실행되지 않는다.

실제 실행 시점은 정렬 중 compare() 내부이다.

```java
k1 = f.apply(u1); // 이때 u1.getAge() 실행
k2 = f.apply(u2); // 이때 u2.getAge() 실행
```

즉,

- 전달 시점: 함수 식만 전달
- 실행 시점: apply() 호출 시

---

## 7. 전체 흐름을 매개변수 관점에서 정리

```text
User::getAge
   ↓ (매개변수 식으로 전달)
Function<User, Integer>
   ↓
Comparator.comparing(Function)
   ↓
Comparator<User> 생성
   ↓
sort()에서 compare() 반복 호출
```

---

## 8. f는 어디서 생기는가?

```java
Comparator.comparing(User::getAge)
```

이 코드는 개념적으로 다음과 동일하다.

```java
Function<User, Integer> f = User::getAge;
Comparator<User> comp = Comparator.comparing(f);
```

즉,

- f는 사용자가 선언한 변수가 아니라
- comparing()의 매개변수로 **내부에서 사용되는 개념적 변수**이다

---

## 9. 한 문장 요약 

`User::getAge`는 `Comparator.comparing()`에  
매개변수 식으로 전달되며,  
타깃 타입에 의해 `Function<User, Integer>`로 해석되고,  
실제 실행은 정렬 중 apply()가 호출될 때 발생한다.
