# Java Function.apply() 완전 정리

## 1. Function 인터페이스 구조

자바에는 이미 다음과 같은 함수형 인터페이스가 정의되어 있다.

```java
@FunctionalInterface
public interface Function<T, R> {
    R apply(T t);
}
```

- T : 입력 타입
- R : 반환 타입
- 추상 메서드는 apply 하나뿐
- 람다식으로 구현 가능

---

## 2. Function.apply 직접 구현 (익명 클래스)

```java
Function<User, Integer> f = new Function<User, Integer>() {
    @Override
    public Integer apply(User u) {
        return u.getAge();
    }
};
```

사용 예시:

```java
User user = new User(25);
Integer age = f.apply(user);
System.out.println(age); // 25
```

apply는 단순한 메서드 호출이다.

---

## 3. 람다식으로 축약한 형태

```java
Function<User, Integer> f = u -> u.getAge();
```

컴파일러 해석:

```java
Integer apply(User u) {
    return u.getAge();
}
```

호출 방식은 동일하다.

```java
f.apply(user);
```

---

## 4. Comparator 코드에 대입했을 때의 변환

원본 코드:

```java
Comparator<User> comp = (u1, u2) ->
    f.apply(u1).compareTo(f.apply(u2));
```

apply를 실제 메서드 호출로 치환:

```java
Comparator<User> comp = (u1, u2) ->
    u1.getAge().compareTo(u2.getAge());
```

- f.apply(u)는 내부적으로 u.getAge() 호출
- 의미적으로 완전히 동일

---

## 5. 실행 흐름 단계별 분석

```java
User u1 = new User(20);
User u2 = new User(30);

Integer a = f.apply(u1); // u1.getAge() → 20
Integer b = f.apply(u2); // u2.getAge() → 30

int result = a.compareTo(b); // -1
```

실행 순서:
1. apply 호출
2. 객체에서 값 추출
3. compareTo 수행
4. 결과 반환

---

## 6. 타입 변경 예제 (문자열 길이)

```java
Function<String, Integer> lengthFunc = s -> s.length();
```

```java
Integer len = lengthFunc.apply("hello");
System.out.println(len); // 5
```

입력 하나를 받아 결과 하나를 반환한다.

---

## 7. 숫자 제곱 Function 예제

```java
Function<Integer, Integer> square = x -> x * x;
```

```java
System.out.println(square.apply(4)); // 16
```

컴파일러 관점 해석:

```java
Integer apply(Integer x) {
    return x * x;
}
```

---

## 8. Stream에서 apply 호출되는 위치

```java
List<User> users = List.of(
    new User(20),
    new User(30)
);

List<Integer> ages =
    users.stream()
         .map(f)
         .toList();
```

내부 동작 개념:

```java
for (User u : users) {
    result.add(f.apply(u));
}
```

Stream의 map은 각 요소마다 apply를 호출한다.

---

## 9. 핵심 요약

Function.apply(x)는  
람다로 정의한 로직을 실제 값에 적용하는 메서드 호출이며,  
문법적으로는 일반 메서드 호출이고,  
의미적으로는 입력 → 출력 변환이다.
