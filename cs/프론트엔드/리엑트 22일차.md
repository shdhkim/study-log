# 복사, 비교, Immutable 개념 정리

## 1. 값과 참조

### Primitive (값 타입)

-   number
-   string
-   boolean
-   null / undefined

특징: 값 자체가 저장됨

    let a = 10;
    let b = a;
    b = 20;

    a = 10
    b = 20

서로 영향 없음.

------------------------------------------------------------------------

### Reference (참조 타입)

-   object
-   array
-   function

특징: 메모리 주소를 저장

    let a = {age:20};
    let b = a;
    b.age = 30;

    a.age = 30

같은 객체를 가리킨다.

------------------------------------------------------------------------

## 2. 참조복사 (Reference Copy)

    const state = { user:{age:20} };
    const next = state;

특징: - 새 객체 생성 없음 - 주소만 복사 - 가장 위험

결과:

    next.user.age = 40;
    state.user.age === 40

------------------------------------------------------------------------

## 3. 얕은복사 (Shallow Copy)

    const state = { user:{age:20} };
    const next = {...state};

특징: - 겉 객체만 새로 생성 - 내부 객체는 공유

비교:

    state === next → false
    state.user === next.user → true

------------------------------------------------------------------------

## 4. 깊은복사 (Deep Copy)

    const next = JSON.parse(JSON.stringify(state));

특징: - 내부 객체까지 전부 새로 생성 - 완전 분리

비교:

    state.user === next.user → false

단점: - 느림 - Date, 함수, undefined 손상

------------------------------------------------------------------------

## 5. 배열 복사

### 참조복사

    const b = arr;

### 얕은복사

    const b = [...arr];

### 깊은복사

    const b = JSON.parse(JSON.stringify(arr));

배열 안 객체는 얕은복사 시 공유된다.

------------------------------------------------------------------------

## 6. 얕은비교 (Shallow Comparison)

정의: \> 객체 내부 값은 비교하지 않고 참조만 비교

    prev === next

객체:

    {a:1} === {a:1} → false

같은 객체:

    const a = {a:1};
    const b = a;
    a === b → true

React는 이 비교를 사용해 렌더링 여부를 판단한다.

------------------------------------------------------------------------

## 7. Immutable 개념

특징: - 원본 수정 불가 - 변경 시 새 상태 생성

    const next = state.set("a",10);

원본 유지, 새 객체 반환.

------------------------------------------------------------------------

## 8. 구조적 공유 (Structural Sharing)

변경된 경로만 새로 생성하고 나머지는 재사용.

예:

    state
     └ user
        └ profile
           └ age

age 변경 시: - age 새 객체 - profile 새 객체 - user 새 객체 - state 새
객체 - 다른 가지는 재사용

------------------------------------------------------------------------

## 9. Immutable 연산

### push (List)

새 리스트 생성

### set

특정 키 교체

### setIn

중첩 경로 교체

### update

기존 값 기반 계산

### merge

여러 값 한 번에 변경

### mergeDeep

중첩 병합

모든 연산은 수정이 아니라 새 상태 생성이다.

------------------------------------------------------------------------

## 10. 복사 방식 비교

  방식        겉 객체           내부 객체
  ----------- ----------------- ---------------
  참조복사    공유              공유
  얕은복사    새로              공유
  깊은복사    새로              새로
  Immutable   변경경로만 새로   나머지 재사용

------------------------------------------------------------------------

## 11. React와의 관계

React는 다음 기준으로 변경 감지:

    prevState === nextState ?

-   참조복사: 감지 실패
-   얕은복사: 일부 실패
-   깊은복사: 정확하지만 느림
-   Immutable: 정확하고 빠름

------------------------------------------------------------------------

## 12. 최종 요약

-   참조복사: 같은 객체를 공유
-   얕은복사: 1단계만 복사
-   깊은복사: 전체 복제
-   얕은비교: 참조만 비교
-   Immutable: 변경 경로만 새 객체 생성

핵심: Immutable은 깊은복사처럼 안전하면서, 얕은비교로 변경 감지가
가능하도록 만든 자료구조이다.
